function makeSwiper(){var e={direction:"horizontal",touchMoveStopPropagation:!0,paginationClickable:!0,pagination:".swiper-pagination",iOSEdgeSwipeDetection:!0,flip:{slideShadows:!1},onTransitionEnd:function(e,r){console.log("slide"),httpAnswer()}};return new Swiper(".swiper-container",e)}var app=angular.module("myApp",["ngRoute","ui.router","angular-md5","ngSanitize","ngCookies"]);app.config(function(e,r){r.when("","/personal"),e.state("personal",{url:"/personal",templateUrl:"./html/personal.html",controller:"personalCtrl"}).state("basicSituation",{url:"/basicSituation",templateUrl:"./html/basicSituation.html",controller:"basicSituationCtrl"}).state("medicalHistory",{url:"/medicalHistory",templateUrl:"./html/medicalHistory.html",controller:"medicalHistoryCtrl"}).state("habitsCustoms",{url:"/habitsCustoms",templateUrl:"./html/habitsCustoms.html",controller:"habitsCustomsCtrl"}).state("medication",{url:"/medication",templateUrl:"./html/medication.html",controller:"medicationCtrl"}).state("breast",{url:"/breast",templateUrl:"./html/breast.html",controller:"breastCtrl"}).state("login",{url:"/login",templateUrl:"./html/login.html",controller:"loginCtrl"})});var allFactory={userId:"",teleNum:"",password:"",HASHPASSWD:"",tagIP:"http://10.24.14.92",postRegister:"//120.27.49.154/BreastCancer/register",postLogin:"//120.27.49.154/BreastCancer/login",ipAddress:"//120.27.49.154/BreastCancer/getQuestion",setAnwserAddress:"//120.27.49.154/BreastCancer/getInsertInfo",isLogin:!1,isRemember:!0};app.directive("bindHtmlCompile",["$compile",function(e){return{restrict:"A",link:function(r,n,s){r.$watch(function(){return r.$eval(s.bindHtmlCompile)},function(s){n.html(s),e(n.contents())(r)})}}}]);var httpAnswer;app.filter("to_trusted",["$sce",function(e){return function(r){return e.trustAsHtml(r)}}]),app.filter("to_compile",["scope","$compilr",function(e,r){return function(e){return r(e)($scope)}}]),app.filter("httpClickFilter",function(e,r,n){return n.httpLinkClick=function(){console.log(234)},function(s){return e.trustAsHtml(r('<div style="background-color:#000">'+s+"</div>")(n).html())}}),app.directive("repeatFinish",function(){return{link:function(e,r,n){1==e.$last&&(e.rootSwiper=makeSwiper(),console.log("ng-repeat render finish"))}}});var sumWeight=function(e){for(var r=[],n=0;n<e.length;n++)!e[n].options||"0"!=e[n].questionAnswerType&&"1"!=e[n].questionAnswerType&&"2"!=e[n].questionAnswerType&&"4"!=e[n].questionAnswerType&&"5"!=e[n].questionAnswerType&&"7"!=e[n].questionAnswerType?"3"==e[n].questionAnswerType||"6"==e[n].questionAnswerType?r[n]=2:r[n]=2:r[n]=e[n].options.length+1;return console.log(r),splitWeight(r,e)},splitWeight=function(e,r){var n=0,s=0,t=[];for(var o in e)e[o]+s<=13?s+=e[o]:(s=0,t[n]=o,n+=1);if(0==t.length)return[r];console.log(t);var l=[];for(var a in t)0==a?l[a]=r.slice(0,t[a]):l[a]=r.slice(t[a-1],t[a]),l[t.length]=r.slice(t[t.length-1],t[t.length]);return l},takePagesNum=function(e){var r=$(".swiper-pagination");for(var n in e)r.append('<span class="swiper-pagination-bullet"></span>')};app.controller("personalCtrl",function(e,r,n,s,t,o,l,a){console.log("personalCtrl  p1"),$(".icon-gerenxinxi").addClass("active"),$(".swiper-slide").height($(window).height()-50),e.setModOneQue=function(e){console.log(e)},r.alertLogin=function(){swal({title:"登录",allowOutsideClick:!1,showCloseButton:!1,animation:!1,input:"password",inputPlaceholder:"密码(6-10位)",html:'<div class="weui-cell__hd"><input type="checkbox" class="loginCheckbox" name="checkbox1" id="loginCheckbox" checked="checked"><span>记住密码自动登录</span></div><input class="swal2-input" id="teleNum" placeholder="手机号/用户名" type="text" style="display: block;" autofocus>',inputValidator:function(e){return new Promise(function(r,n){$teleNum=$("#teleNum").val(),/^1(3|4|5|7|8)\d{9}$/.test($teleNum)&&e.length>=6&&e.length<=10?r():n(/^1(3|4|5|7|8)\d{9}$/.test($teleNum)?"请正确填写密码!":"请正确填写手机号!")})},showCancelButton:!0,confirmButtonText:"登录",cancelButtonText:"去注册"}).then(function(s){allFactory.teleNum=$("#teleNum").val(),allFactory.password=s,allFactory.HASHPASSWD=l.createHash(s),n.post(allFactory.postLogin,{teleNum:allFactory.teleNum,password:allFactory.HASHPASSWD,roleName:"patient",isRemember:allFactory.isRemember}).success(function(n){n.msg?(allFactory.isLogin=!0,allFactory.userId=n.userId,e.getPage(),allFactory.isRemember?window.localStorage.userInfo=JSON.stringify({teleNum:allFactory.teleNum,password:allFactory.HASHPASSWD}):window.localStorage.clear(),swal.resetDefaults(),swal({title:"登录成功",type:"success",showCancelButton:!1,showConfirmButton:!1,text:"请开始填写问卷，2秒后关闭",timer:2e3}).then(function(){},function(e){"timer"===e&&console.log("I was closed by the timer")})):swal("错误",n.errorText,"error").then(function(){r.alertLogin()})})},function(r){"cancel"===r&&e.alertRegister()})["catch"](swal.noop)},e.alertRegister=function(){swal.setDefaults({input:"text",confirmButtonText:"下一步&rarr;",allowOutsideClick:!1,showCloseButton:!1,showCancelButton:!0,animation:!1,cancelButtonText:"去登录",progressSteps:["1","2","3","4"]});var s,t=[{title:"手机号码",input:"text",inputPlaceholder:"请输入您的真实手机号码",confirmButtonText:"发送验证码",inputValidator:function(e){return new Promise(function(r,n){/^1(3|4|5|7|8)\d{9}$/.test(e)?(allFactory.teleNum=e,r()):n("请输入正确的手机号")})}},{title:"验证码",input:"text",inputPlaceholder:"请填入刚刚收到的验证码"},{title:"密码",input:"password",inputPlaceholder:"密码(6-10位)",inputValidator:function(e){return new Promise(function(r,n){e.length>=6&&e.length<=10?(s=e,r()):n("请按格式正确输入密码")})}},{title:"重复输入密码",input:"password",confirmButtonText:"注册",inputPlaceholder:"重复输入密码(6-10位)",inputValidator:function(r){return new Promise(function(t,o){r.length>=6&&r.length<=10&&r==s?(allFactory.password=s,allFactory.HASHPASSWD=l.createHash(s),n.post(allFactory.postRegister,{teleNum:allFactory.teleNum,password:allFactory.HASHPASSWD,roleName:"patient"}).success(function(r){r.msg?(allFactory.userId=r.userId,t(),allFactory.isLogin=!0,e.getPage()):(swal.resetDefaults(),swal("错误",r.errorText,"error").then(function(){e.alertRegister()}))})):o(r!=s?"密码输入不符":"请按格式正确输入密码")})}}];swal.queue(t).then(function(e){swal.resetDefaults(),swal({title:"注册成功",type:"success",showCancelButton:!1,showConfirmButton:!1,text:"请开始填写问卷，2秒后关闭",timer:2e3}).then(function(){},function(e){"timer"===e&&console.log("I was closed by the timer")})},function(e){"cancel"===e&&(swal.resetDefaults(),r.alertLogin())})};var i=1;e.userAnswer=[],e.fillBlank=function(r,n){alert("s");var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[n],t=!0)}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.chooseSin=function(r,n){var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[n],t=!0)}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.chooseDou=function(r,n){var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){if(e.UUID==r){var s=!1;_.each(e.answerId,function(r,t){r==n&&(e.answerId.splice(t,1),s=!0)}),s||e.answerId.push(n),t=!0}}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.setModOneQue=function(r){console.log(r),e.setModOne=r},e.getPage=function(){n.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:i}).success(function(n){console.log(n),n.msg?(e.modOne=sumWeight(_.flatten(n.body.questions)),e.setModOneQue(e.modOne)):(swal("网络错误，请重试",n.errorText,"error"),r.alertLogin())}).error(function(e,r,n,s){swal("网络错误","错误信息："+r,"error")})},httpAnswer=function(){n.post(allFactory.setAnwserAddress,{userId:allFactory.userId,paperModule:i,answer:e.userAnswer}).success(function(e){e.msg?console.log(e.body):swal("网络错误，请重试",e.errorText,"error")}).error(function(e,r,n,s){swal("网络错误","错误信息："+r,"error")})},e.nextMode=function(){o.go("basicSituation",{})},allFactory.isLogin||window.localStorage.userInfo?(allFactory.teleNum=JSON.parse(window.localStorage.userInfo).teleNum,allFactory.HASHPASSWD=JSON.parse(window.localStorage.userInfo).HASHPASSWD,swal("已登录","账号："+allFactory.teleNum,"success"),e.getPage()):r.alertLogin()}),app.controller("basicSituationCtrl",function(e,r,n,s,t,o,l){console.log("basicSituationCtrl  p2"),$(".icon-xinyongqingkuang-copy").addClass("active"),$(".swiper-slide").height($(window).height()-50);var a=2;e.userAnswer=[],e.fillBlank=function(r,n){alert("s");var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[n],t=!0)}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.chooseSin=function(r,n){var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[n],t=!0)}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.chooseDou=function(r,n){var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){if(e.UUID==r){var s=!1;_.each(e.answerId,function(r,t){r==n&&(e.answerId.splice(t,1),s=!0)}),s||e.answerId.push(n),t=!0}}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.setModTwoQue=function(r){console.log(r),e.setModTwo=r},e.getPage=function(){n.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:a}).success(function(n){console.log(n),n.msg?(e.modTwo=sumWeight(_.flatten(n.body.questions)),e.setModTwoQue(e.modTwo)):(swal("网络错误，请重试",n.errorText,"error"),r.alertLogin())}).error(function(e,r,n,s){swal("网络错误","错误信息："+r,"error")})},httpAnswer=function(){n.post(allFactory.setAnwserAddress,{userId:allFactory.userId,paperModule:a,answer:e.userAnswer}).success(function(e){e.msg?console.log(e.body):swal("网络错误，请重试",e.errorText,"error")}).error(function(e,r,n,s){swal("网络错误","错误信息："+r,"error")})},e.nextMode=function(){o.go("medicalHistory",{})},e.prevMode=function(){o.go("personal",{})},e.getPage()}),app.controller("medicalHistoryCtrl",function(e,r,n,s,t,o,l){console.log("medicalHistoryCtrl  p3"),$(".icon-bingli").addClass("active"),$(".swiper-slide").height($(window).height()-50);var a=3;e.userAnswer=[],e.fillBlank=function(r,n){alert("s");var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[n],t=!0)}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.chooseSin=function(r,n){var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[n],t=!0)}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.chooseDou=function(r,n){var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){if(e.UUID==r){var s=!1;_.each(e.answerId,function(r,t){r==n&&(e.answerId.splice(t,1),s=!0)}),s||e.answerId.push(n),t=!0}}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.setModThreeQue=function(r){console.log(r),e.setModThree=r},e.getPage=function(){n.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:a}).success(function(n){console.log(n),n.msg?(e.modThree=sumWeight(_.flatten(n.body.questions)),e.setModThreeQue(e.modThree)):(swal("网络错误，请重试",n.errorText,"error"),r.alertLogin())}).error(function(e,r,n,s){swal("网络错误","错误信息："+r,"error")})},httpAnswer=function(){n.post(allFactory.setAnwserAddress,{userId:allFactory.userId,paperModule:a,answer:e.userAnswer}).success(function(e){e.msg?console.log(e.body):swal("网络错误，请重试",e.errorText,"error")}).error(function(e,r,n,s){swal("网络错误","错误信息："+r,"error")})},e.nextMode=function(){o.go("habitsCustoms",{})},e.prevMode=function(){o.go("basicSituation",{})},e.getPage()}),app.controller("habitsCustomsCtrl",function(e,r,n,s,t,o,l){console.log("habitsCustomsCtrl  p4"),$(".icon-shenghuo").addClass("active"),$(".swiper-slide").height($(window).height()-50);var a=4;e.userAnswer=[],e.fillBlank=function(r,n){alert("s");var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[n],t=!0)}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.chooseSin=function(r,n){var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[n],t=!0)}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.chooseDou=function(r,n){var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){if(e.UUID==r){var s=!1;_.each(e.answerId,function(r,t){r==n&&(e.answerId.splice(t,1),s=!0)}),s||e.answerId.push(n),t=!0}}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.setModFourQue=function(r){console.log(r),e.setModFour=r},e.getPage=function(){n.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:a}).success(function(n){console.log(n),n.msg?(e.modFour=sumWeight(_.flatten(n.body.questions)),e.setModFourQue(e.modFour)):(swal("网络错误，请重试",n.errorText,"error"),r.alertLogin())}).error(function(e,r,n,s){swal("网络错误","错误信息："+r,"error")})},httpAnswer=function(){n.post(allFactory.setAnwserAddress,{userId:allFactory.userId,paperModule:a,answer:e.userAnswer}).success(function(e){e.msg?console.log(e.body):swal("网络错误，请重试",e.errorText,"error")}).error(function(e,r,n,s){swal("网络错误","错误信息："+r,"error")})},e.nextMode=function(){o.go("medication",{})},e.prevMode=function(){o.go("medicalHistory",{})},e.getPage()}),app.controller("medicationCtrl",function(e,r,n,s,t,o,l){console.log("medicationCtrl  p5"),$(".icon-yao").addClass("active"),$(".swiper-slide").height($(window).height()-50);var a=5;e.userAnswer=[],e.fillBlank=function(r,n){alert("s");var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[n],t=!0)}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.chooseSin=function(r,n){var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[n],t=!0)}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.chooseDou=function(r,n){var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){if(e.UUID==r){var s=!1;_.each(e.answerId,function(r,t){r==n&&(e.answerId.splice(t,1),s=!0)}),s||e.answerId.push(n),t=!0}}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.setModFiveQue=function(r){console.log(r),e.setModFive=r},e.getPage=function(){n.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:a}).success(function(n){console.log(n),n.msg?(e.modFive=sumWeight(_.flatten(n.body.questions)),e.setModFiveQue(e.modFive)):(swal("网络错误，请重试",n.errorText,"error"),r.alertLogin())}).error(function(e,r,n,s){swal("网络错误","错误信息："+r,"error")})},httpAnswer=function(){n.post(allFactory.setAnwserAddress,{userId:allFactory.userId,paperModule:a,answer:e.userAnswer}).success(function(e){e.msg?console.log(e.body):swal("网络错误，请重试",e.errorText,"error")}).error(function(e,r,n,s){swal("网络错误","错误信息："+r,"error")})},e.nextMode=function(){o.go("breast",{})},e.prevMode=function(){o.go("habitsCustoms",{})},e.getPage()}),app.controller("breastCtrl",function(e,r,n,s,t,o,l){console.log("breastCtrl  p6"),$(".icon-zhishichanquan2").addClass("active"),$(".swiper-slide").height($(window).height()-50);var a=6;e.userAnswer=[],e.fillBlank=function(r,n){alert("s");var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[n],t=!0)}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.chooseSin=function(r,n){var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){e.UUID==r&&(e.answerId=[n],t=!0)}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.chooseDou=function(r,n){var s={UUID:r,answerId:[n]};if(0!=e.userAnswer.length){var t=!1;_.each(e.userAnswer,function(e){if(e.UUID==r){var s=!1;_.each(e.answerId,function(r,t){r==n&&(e.answerId.splice(t,1),s=!0)}),s||e.answerId.push(n),t=!0}}),t||e.userAnswer.push(s)}else e.userAnswer.push(s);console.log(e.userAnswer)},e.setModSixQue=function(r){console.log(r),e.setModSix=r},e.getPage=function(){n.post(allFactory.ipAddress,{teleNum:allFactory.teleNum,paperModule:a}).success(function(n){console.log(n),n.msg?(e.modSix=sumWeight(_.flatten(n.body.questions)),e.setModSixQue(e.modSix)):(swal("网络错误，请重试",n.errorText,"error"),r.alertLogin())}).error(function(e,r,n,s){swal("网络错误","错误信息："+r,"error")})},httpAnswer=function(){n.post(allFactory.setAnwserAddress,{userId:allFactory.userId,paperModule:a,answer:e.userAnswer}).success(function(e){e.msg?console.log(e.body):swal("网络错误，请重试",e.errorText,"error")}).error(function(e,r,n,s){swal("网络错误","错误信息："+r,"error")})},e.finishAll=function(){swal("提交成功","","success")},e.prevMode=function(){o.go("medication",{})},e.getPage()}),app.controller("loginCtrl",function(e,r,n){console.log("222")}),app.directive("changePage",function(){return{restrict:"EA",replace:!0,template:'<div class="btn-group btn-group-md"><button type="button" ng-click="prev()" class="btn btn-default">上一页</button><button type="button" ng-click="next()" class="btn btn-default">下一页</button></div>',controller:function(e,r){e.prev=function(){r.swiper.slidePrev()},e.next=function(){r.swiper.slideNext()}}}}),app.directive("prevMode",function(e){return{restrict:"EA",replace:!0,scope:{pageUrl:"&infoMode"},template:'<div class="btn-group btn-group-md"><button type="button" ng-click="prev()" class="btn btn-default">上一章</button><button type="button" ng-click="next()" class="btn btn-default">下一页</button></div>',controller:function(e,r,n){e.prev=function(){n.go(e.pageUrl,{})},e.next=function(){r.swiper.slideNext()}}}}),app.directive("nextMode",function(e){return{restrict:"EA",replace:!0,scope:{pageUrl:"@infoMode"},template:'<div class="btn-group btn-group-md"><button type="button" ng-click="prev()" class="btn btn-default">上一页</button><button type="button" ng-click="next()" class="btn btn-default">下一章</button></div>',controller:function(e,r,n){e.prev=function(){r.swiper.slidePrev()},e.next=function(){n.go(e.pageUrl,{})}}}});
//# sourceMappingURL=app.js.map
